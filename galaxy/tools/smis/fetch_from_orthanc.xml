<tool id="smis_fetch_from_orthanc" name="Fetch DICOM from Orthanc" version="0.1" profile="21.01">
  <description>Download a Study via DICOMweb (QIDO/WADO-RS) and bundle as a tar</description>

  <requirements>
    <requirement type="package" version="2.31">requests</requirement>
  </requirements>

  <command detect_errors="exit_code"><![CDATA[
python $__tool_directory__/scripts/fetch_from_orthanc.py \
  --orthanc-url '${orthanc_url}' \
  --study-uid '${study_uid}' \
  --out '${out_file}'
  ]]></command>

  <inputs>
    <param name="orthanc_url" type="text" value="http://orthanc:8042" label="Orthanc URL"/>
    <param name="study_uid" type="text" label="StudyInstanceUID" help="e.g., 1.2.840...."/>
  </inputs>

  <outputs>
    <data name="out_file" format="tar" label="DICOM_${study_uid}.tar"/>
  </outputs>

  <help><![CDATA[
Fetches all instances for the given StudyInstanceUID from Orthanc using DICOMweb (QIDO/WADO-RS) and packs them into a tarball.
  ]]></help>
</tool>
